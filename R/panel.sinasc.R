#' Panel SINASC
#'
#'  The function label.sinasc treat the data frame about the SINASC after download with the download.sinasc function.
#'  But many columns are unnecessary for the Power BI Dashboard, so this function select the columns needed and reat the columns names.
#' @param data SINASC data frame generated by the function label.sinasc.
#'
#' @seealso \code{\link{download.sinasc}\link{label.sinasc}}
#' @return A data frame from SINASC with the columns needed for the Power BI dashboard.
#' @export
#'
#' @examples
#' fNasc_Vivos <- panel.sinasc(db_label)
panel.sinasc <- function(data){
  require(dplyr)
  base <- data %>%
    select(`Código do Estabelecimento`=CODESTAB,`Estabelecimento`=ESTABELECIMENTO,`Local de Nascimento`=LOCNASC,

           `Código Município de Nascimento`=CODMUNNASC,`UF de Nascimento`=UFNASC,`Região de Nascimento`=REGIAO_NASC,`Vínculo`=VINCULO,`Município de Nascimento`=MUNNASC,

           `Sexo`=SEXO,`Peso`=PESO,`Faixa de Peso`=FAIXA_PESO,`Semanas de Gestação`=SEMAGESTAC,`Gestação`=GESTACAO,`Gravidez`=GRAVIDEZ,

           `Parto`=PARTO,`Data de Nascimento`=DTNASC,`Hora de Nascimento`=HORANASC,`Ano`=ANO,`Mês-Ano`=MES_ANO,`Raça/Cor`=RACACOR,

           `Consultas Pré-Natal`=CONSULTAS, APGAR1, APGAR5,`Faixa APGAR5`=FAIXA_APGAR5,`Idade da Mãe`= IDADEMAE,

           `Faixa Etária da Mãe`=FAIXA_ETARIA_MAE,`Estado Civil da Mãe` = ESTCIVMAE,`Raça/Cor da Mãe`=RACACORMAE,

           `Escolaridade da Mãe` = ESCMAE2010,`Anos de Escolaridade da Mãe` = ESCMAE, `Código Município de Residência`=CODMUNRES,

           `Município de Residência da Mãe`= MUNRES,`UF de Residência da Mãe`=UFRES,`Região de Residência da Mãe`=REGIAO_RES,`Ocupação da Mãe`=OCUPMAE,`Anomalia Congênita`=IDANOMAL,

           `Código Faixa Etária`=COD_FAIXA_ETARIA,`Código Faixa Peso`=COD_FAIXA_PESO,`Código Gestação`=COD_GESTACAO,

           `Código Consultas`=COD_CONSULTAS, `Código Escolaridade`=COD_ESCOLARIDADE,`Código Gravidez`=COD_GRAVIDEZ)

  colnames(base) <- iconv(colnames(base), to = "UTF-8")

  base[-35] <- lapply(base[-35], function(col) {
    if (is.character(col)) iconv(col, to = "UTF-8") else col
  })

  return(base)
}
